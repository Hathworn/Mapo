// Ensure coalesced memory access for deviceDataIn and deviceDataOut
// Use shared memory for repeated data in threads if applicable
// Consider loop unrolling if keySize is small for efficiency