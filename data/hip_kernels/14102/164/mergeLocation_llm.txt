// Ensure coalesced memory access by using __restrict__ pointers
// Use __fmul_rn for fast and precise floating-point multiplication
// Avoid branching with an early return for out-of-bounds indices