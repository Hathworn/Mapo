// Use shared memory to reduce memory latency
// Assuming blockDim.x is 256
// Loop with stride and cache the data in shared memory