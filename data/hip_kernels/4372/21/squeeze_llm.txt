```c
// Ensure coalesced memory access for B to improve memory throughput.
// Consider using shared memory for intermediate calculations if necessary.
// Ensure all threads participate to avoid warp divergence.
```