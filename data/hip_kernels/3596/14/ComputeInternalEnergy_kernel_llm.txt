// Use shared memory to reduce global memory access
// Ensure memory coalescing by aligning data structures
// Minimize divergent branches by checking memory bounds first
// Consider using constant memory for read-only Etot array if frequently accessed