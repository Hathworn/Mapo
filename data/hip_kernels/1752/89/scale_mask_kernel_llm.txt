```
// Consider coalesced memory accesses by ensuring consecutive threads access consecutive elements for 'x' and 'mask'.
// Load 'mask_num' and 'scale' into local variables to reduce redundant global memory access.
```