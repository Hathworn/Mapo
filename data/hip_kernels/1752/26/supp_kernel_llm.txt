// Consider using shared memory for frequently accessed values
// Minimize redundant calculations outside of branches
// Use coalesced memory access patterns for `X` array
// Avoid warp divergence by simplifying condition logic