```
// Consider using shared memory to reduce global memory load
// Precompute squared distance to optimize calculations
// Avoid excessive branching within the inner loop
// Minimize memory writes by pre-filling sample indices outside the loop
// Consolidate redundant calculations outside the nested loops
```