```
// Consider using shared memory for points to reduce global memory access latency
// Ensure memory coalescing when accessing the idx array for better performance
// Check if loop unrolling can improve the performance of the inner loops
// Minimize register usage by optimizing variable usage within loops
// Profile kernel to ensure high occupancy while maintaining efficient memory access patterns
```
