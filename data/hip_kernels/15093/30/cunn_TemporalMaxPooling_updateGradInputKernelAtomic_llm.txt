// Reduce repeated calculations outside the loop 
// Minimize memory access by using registers for offset indices