// Use shared memory for max computation to reduce global memory access  
// Calculate max, reuse shared_mem for different iterations  
// Calculate logsum using loop unrolling to optimize performance  