// Calculate in_x and in_y once to reduce operation counts
// Use clamp to handle boundaries and simplify logic
// Directly perform the memory copy using calculated indices