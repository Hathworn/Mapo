```
// Ensure coalesced memory access by aligning data structures
// Consider using shared memory to reduce global memory bandwidth
// Implement loop unrolling for the lifter coefficients application
// Use warp-level primitives to optimize energy application
// Minimize branch divergence in the energy application logic
// Ensure that num_cols is a multiple of warp size for best performance
```