```
// Optimize: Coalesce memory access patterns for probs array
// Optimize: Pre-compute memory offset for the current case
// Optimize: Use a loop with stride to reduce multiplication
```