```
// Check bounds early to avoid unnecessary computation
// Unrolled loop for performance
// Update p1 efficiently
```