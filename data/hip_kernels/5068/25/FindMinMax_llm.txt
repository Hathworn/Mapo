```cpp
// Use shared memory to reduce global memory accesses
// Replace hardcoded values with blockDim.x and blockDim.y for better scalability
// Use fminf and fmaxf for optimized floating-point operations
// Minimize thread divergence by checking boundary conditions once
```