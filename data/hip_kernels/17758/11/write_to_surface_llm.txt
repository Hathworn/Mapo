// Ensure x and y are within bounds
// Unroll loop for efficiency
// Coalesced memory access