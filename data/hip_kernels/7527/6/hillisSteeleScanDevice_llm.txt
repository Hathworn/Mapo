// Use shared memory to reduce global memory accesses
// Unroll loops for reduced branching and improved performance