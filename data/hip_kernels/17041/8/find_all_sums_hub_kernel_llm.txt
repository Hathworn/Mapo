// Use shared memory for node_weight array to improve memory access efficiency
// Unroll loop to reduce loop overhead