// Optimize global thread index calculation to avoid unnecessary multiplications.
// Enhance readability and efficiency by simplifying check structures and logical flows.
// Reduce the number of array lookups to minimize memory access overhead.
// Optimize operations by consolidating redundant computations.
// Improve performance by handling special cases separately and efficiently.