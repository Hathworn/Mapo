// Use shared memory to reduce global memory accesses.
// Employ ternary operator for conditional assignments to streamline logic.
// Replace division operation with bitwise right shift for faster computation.
// Limit final assignments to the first 4 elements for reduced checks and improved efficiency.