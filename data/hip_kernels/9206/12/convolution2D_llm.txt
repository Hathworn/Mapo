```cpp
// Optimize: Calculate row index using block and thread.
// Optimize: Calculate column index using block and thread.
// Optimize: Combine boundary checks in a single condition.
```