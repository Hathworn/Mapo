```
// Use shared memory to cache frequently accessed maskBuffer values for faster access
// Optimize memory access patterns to ensure coalesced memory reads
// Consider using texture memory for maskBuffer if access patterns fit the texture cache model
// Flatten parallelism by using dynamic parallelism to handle varying segment sizes
```