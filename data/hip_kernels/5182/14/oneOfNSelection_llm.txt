```cpp
// Consider coalesced memory access for buffer and index arrays
// Ensure index array is cached in shared memory if reused frequently
// Avoid warp divergence by ensuring consistent control flow
```