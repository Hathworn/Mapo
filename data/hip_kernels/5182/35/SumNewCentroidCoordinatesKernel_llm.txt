```cpp
// Consider coalesced memory access for nearestCentroid array
// Optimize memory access pattern for input array to improve bandwidth utilization
// Use shared memory effectively to minimize global memory access
// Employ warp-level primitives to further reduce the number of atomic operations
```