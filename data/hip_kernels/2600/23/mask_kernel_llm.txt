```
// Use shared memory to reduce global memory access
// Prefetch mask_num into shared memory
// Minimize divergent branches by aligning conditions
// Ensure memory accesses are coalesced for optimized performance
```