// Reorganize index calculations to minimize arithmetic operations
// Combine nested loops to improve cache efficiency
// Consider memory coalescing when accessing elements in x
// Optimize loop bounds checking by ensuring loops will always run