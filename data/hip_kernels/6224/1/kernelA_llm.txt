```cpp
// Ensure coalesced memory access for 'x', 'y', 'z', and 'r' by accessing consecutive threads
// Minimize memory traffic by using shared memory if data reuse occurs within a block
// Consider loop unrolling for the main computation to reduce overhead
```