// Optimize by removing redundant calculations  
// Compute index outside the condition  
// Use precomputed index