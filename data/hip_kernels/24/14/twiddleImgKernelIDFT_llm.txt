// Use shared memory to reduce global memory access
// Pointer indexing to simplify index calculation
// Load w into shared memory for faster access
// Ensure all threads have loaded w
// Use shared memory for computation