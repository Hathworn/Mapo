// Pre-calculate index to reduce redundant calculations
// Ensure coalesced access by using blockDim.x and gridDim values efficiently
// Use conditional execution to prevent out-of-bound memory access