// Reduce division operations inside the loop by calculating constant values before the loop
// Minimize memory access by calculating baseIndex outside the loop