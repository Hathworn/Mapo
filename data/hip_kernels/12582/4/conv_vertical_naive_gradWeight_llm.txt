```cpp
// Use shared memory to reduce global memory accesses for idx calculations.
// Consider using cooperative groups for better synchronization control.
// Optimize memory access patterns to coalesce global memory reads and writes.
```