// Use bitwise AND instead of modulo for power of 2 indices to optimize integer operations.
// Load values from global memory to registers to reduce global memory access latency.
// Use multiplication instead of division for averaging to optimize arithmetic operations.
// Simplify final expression to decrease register pressure.