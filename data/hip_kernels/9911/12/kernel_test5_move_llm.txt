// Improve memory access patterns by coalescing memory accesses
// Further optimize shared memory usage to minimize bank conflicts
// Consider using warp-level primitives for better performance on the last section
// Expand early exit condition to include end_ptr boundary checks