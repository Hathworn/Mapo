```c
// Use shared memory to reduce global memory accesses if possible.
// Coalesce memory accesses to d_nearest_neighbour_indexes to improve bandwidth utilization.
// Ensure memory alignment for d_temp_double_mem for improved access speed.
// Minimize branch divergence by restructuring code to reduce conditional execution paths.
```