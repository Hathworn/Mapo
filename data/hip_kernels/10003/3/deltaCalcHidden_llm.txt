```cpp
// Store commonly used values in local variables to reduce repeated global memory access.
// Ensure 'n' is calculated correctly to avoid out-of-bounds access.
// Consider coalescing global memory access for efficiency.
// Use shared memory if possible to further reduce global memory traffic.
```