```cpp
// Consider using shared memory to cache row_sum and col_sum for faster access.
// Optimize the memory access patterns by ensuring coalesced memory access for output.
```