```
// Consider using shared memory to cache state[idx] for better memory access performance.
// Evaluate using loop unrolling if n is guaranteed to be a multiple of warp size for reduced loop overhead.
// Optimize memory access patterns by ensuring contiguous memory access to reduce global memory transactions.
```