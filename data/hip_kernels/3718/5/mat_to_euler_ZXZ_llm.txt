// Use shared memory to reduce global memory accesses.
// Ensure proper memory coalescing for afMatIn and afEulerOut.
// Optimize thread block size and grid size for better performance and resource utilization.
