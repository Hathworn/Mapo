// Unroll the loop to reduce loop control overhead and improve performance
// Use __expf for faster single-precision floating-point calculation
// Minimize memory access by precomputing exp_val before it is used