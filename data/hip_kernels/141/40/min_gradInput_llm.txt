// Use shared memory to cache indices for faster access
// Minimize global memory access by storing intermediate results in registers