// Optimize loop with shared memory and avoid bank conflicts  
// Load data into shared memory  
// Synchronize threads  
// Write into global memory  