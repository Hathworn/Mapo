```
// Use shared memory for index to reduce global memory access
// Use atomic operation to safely update index in global memory
```