// Optimized: Reading and writing data column-wise to improve memory coalescing