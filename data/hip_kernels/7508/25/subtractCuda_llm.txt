// Consider using shared memory to cache data and reduce global memory access latency.
// Precompute linear indices outside the if condition to save processing time.
// Avoid redundant calculations by reusing already computed indices.