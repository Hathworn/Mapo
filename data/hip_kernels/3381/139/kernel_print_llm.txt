// Ensure coalesced memory access for p[idx] by aligning data structures
// Consider using shared memory to reduce global memory access latency
// Evaluate the block and grid dimensions for optimal occupancy
// Investigate warp divergence and ensure branching is minimized