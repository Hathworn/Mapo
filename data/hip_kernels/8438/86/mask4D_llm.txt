```c
// Use shared memory to cache mask data to reduce global memory access.
// Consider coalescing memory accesses to the 'in' array for better performance.
// Ensure the grid and block dimensions are optimized for your specific hardware.
```