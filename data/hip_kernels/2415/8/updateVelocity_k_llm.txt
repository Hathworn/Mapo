// Ensure coalesced memory access for vx and vy arrays
// Consider using shared memory to optimize pitch-based access
// Precompute normalized values to minimize redundant operations
// Optimize loops by minimizing the arithmetic inside the loop
// Use vectorized operations for float2 assignment