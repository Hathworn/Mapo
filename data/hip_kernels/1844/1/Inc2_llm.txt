// Use register to store value and reduce global memory access
// Accumulate in register
// Only update Bd after inner loop to reduce memory write
// Write back final result to Ad