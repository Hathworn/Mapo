// Use shared memory to cache Ad for faster access
// Reduce the number of global memory writes by using registers
// Consider using warp-based operations to reduce redundant computations
// Optimize loop by unrolling where possible to improve execution time