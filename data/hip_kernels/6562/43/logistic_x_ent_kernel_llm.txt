// Utilize shared memory for faster access and reduced global memory access.
// Reduce computation overhead by precalculating log(p) and log(1-p).
// Minimize branches and computations inside the kernel to improve execution efficiency.