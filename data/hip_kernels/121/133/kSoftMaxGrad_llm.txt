```
// Consider coalesced access patterns for 'mat' and 'target' arrays to improve memory access efficiency.
// Use shared memory to reduce global memory accesses if possible.
// Ensure labels array is accessed efficiently; consider using texture or constant memory if suitable.
```