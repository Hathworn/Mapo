```cpp
// Ensure memory copies are coalesced for better performance.
// Consider using shared memory to store a portion of 'dist' locally.
// Avoid excessive global memory accesses by minimizing swaps.
// Optimize the loop by unrolling where possible for better performance.
// Consider warp-level optimization for parallel efficiency.
```