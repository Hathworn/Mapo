// Use shared memory to reduce global memory access.
// Unroll loop to enhance throughput.