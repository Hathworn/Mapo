```cpp
// Precompute expf(-z) for efficiency
// Derivative calculation optimized by reusing exp_neg_z
// Unroll loop for potential better performance (compiler might optimize further)
```