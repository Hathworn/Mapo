// Unroll loop for better performance  
// Optimize NaN check with combined conditions  
// Optimize memory accesses by coalescing reads and writes when possible  
// Avoid branching within frequently executed code  
