```
// Simplify branch by using a ternary operator
// Optimize loop by using __shfl_down_sync for parallel reduction
```