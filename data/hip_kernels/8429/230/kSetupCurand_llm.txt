// Use shared memory to reduce redundant global memory access for states
// Ensure initialization is done before usage to prevent race conditions