// Precompute indices to minimize re-computation
// Floor rounding for more predictable position
// Fetch once to reduce repeated access