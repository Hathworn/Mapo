// Use shared memory to reduce global memory access
// Consider loop unrolling for spatial dimension
// Optimize memory access patterns for better coalescing
// Reduce pointer arithmetic by calculating offset outside loops