```cpp
// Optimize: Pre-calculate integer part index only once.
// Use switch statement instead of multiple if-else.
// Optimize: Use fmaxf for simpler max calculation.
// Optimize: Use fminf for simpler min calculation.
// Optimize: Simplify thread index calculation.
// Update pixel index directly.
```