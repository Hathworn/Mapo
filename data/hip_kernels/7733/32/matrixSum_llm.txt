```
// Use 1D grid and thread index for better memory coalescing
// Ensure the thread index is within bounds
```