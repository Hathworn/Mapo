// Use 2D threadblock and grid for better memory access pattern
// Combined bounds check for efficiency