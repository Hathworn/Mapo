// Calculate the global index once to avoid recomputation
// Use a single if statement to reduce branching
// Perform memory accesses in a coalesced manner to improve performance