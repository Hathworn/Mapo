// Use local variable for accumulation to reduce global memory access
// Write the result once outside the loop to minimize global memory writes