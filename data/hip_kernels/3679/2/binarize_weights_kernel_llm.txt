// Use shared memory to reduce global memory access.
// Use atomic operations to compute mean more efficiently.
// Rearrange computations to minimize divergence and memory access.