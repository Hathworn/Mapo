// Use shared memory for faster access in cache  
// Each thread initializes its own state in shared memory  
// Copy shared state back to global memory