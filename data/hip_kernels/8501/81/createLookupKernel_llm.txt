// Avoid warp divergence by optimizing condition checks
// Reduce memory access by reusing the loaded value