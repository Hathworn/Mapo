```
// Consider coalescing memory accesses for better memory throughput.
// Ensure p is aligned to support efficient memory transactions.
// Use shared memory to cache p values when accessed multiple times.
// Minimize conditional checks within the kernel for performance.
```