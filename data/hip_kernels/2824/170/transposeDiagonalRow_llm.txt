```c
// Consider coalescing memory access for 'in' array to improve memory throughput.
// Use shared memory to exploit data reuse and reduce global memory accesses.
// Optimize loop bounds to avoid unnecessary checks within the nested loop.
```