```
// Cache block index calculations for thread efficiency.
// Combine bounds checks to minimize branching.
// Reorganize reads for better memory coalescing.
// Eliminate additional pointer arithmetic by direct index access.
```