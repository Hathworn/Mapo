```
// Use fast rounding intrinsic for better performance
// Use __logf for efficient computation of logarithm
// Check if the label probability equals max probability using a boolean
// Unroll loop to reduce overhead and optimize memory access
// Optimize memory access by calculating array indices only once
```