```c
// Use a smaller shared array to reduce resource usage
// Use contiguous threads to improve memory access patterns
// Use atomic operation to prevent race conditions
// Use a single thread to aggregate results using atomic operation
// Use atomic operation to ensure correct updates
```