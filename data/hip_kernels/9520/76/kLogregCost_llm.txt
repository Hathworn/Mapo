```
// Use local variables to minimize global memory access
// Cache maxProbs and labels for better memory coalescing
// Replace division with multiplication for better performance
// Avoid redundant computation by caching numCases, numOut
```