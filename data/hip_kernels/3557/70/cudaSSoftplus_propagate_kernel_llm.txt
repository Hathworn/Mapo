// Use shared memory for improved memory access efficiency  
// Avoid redundant calls to exp() using shared memory  
// Use log1p for better precision