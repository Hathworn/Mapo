```c
// Calculate global index once to optimize index calculations.
// Check for out-of-bounds to prevent invalid memory access.
// Load prediction and truth values once to reduce redundant memory reads.
// Use fabsf for fast absolute value calculation.
// Replace conditional statements with integer comparison for efficient branching.
```