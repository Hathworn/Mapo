```cpp
// Consider using shared memory to store mask values for better memory access efficiency
// Explore coalesced memory access patterns to improve memory throughput
// Use __restrict__ qualifiers for pointer parameters if there are no aliasing concerns
// Ensure that grid size and block size are optimized to achieve full occupancy
```