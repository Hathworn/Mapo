// Calculate the global thread index directly to reduce the number of arithmetic operations
// Quickly exit if the thread is out of bounds
// Use a temporary variable to store the scale value to reduce memory access