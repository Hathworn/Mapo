// Optimize memory access by ensuring coalesced reads and writes.
// Use shared memory for scale_factor if accessed by multiple threads.