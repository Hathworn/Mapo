```
// Optimize the calculation of global thread ID
// Calculate stride for grid-stride loop
// Use grid-stride loop for better occupancy
// Use atomicAdd for safer concurrent writes
```