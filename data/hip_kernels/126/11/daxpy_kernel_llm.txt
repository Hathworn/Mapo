// Use loop to allow coalesced access and increase occupancy