// Use shared memory to cache input data for faster access
// Coalesce memory accesses in 'out' for better performance
// Minimize divergent branches within the if condition