```
// Pre-compute indices to improve warp efficiency
// Mask condition computed outside loop
// Optimized condition checks by combining and minimizing out-of-bound checks
// Factor out m to minimize conditional checks
```