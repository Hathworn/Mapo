```cpp
// Consider coalescing global memory accesses when reading from minmax
// Use shared memory to reduce global memory traffic in val manipulation
// Minimize divergent branches in the loop with val shifting
```