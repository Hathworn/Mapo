```c
// Optimize memory access by ensuring coalesced access patterns
// Ensure sufficient grid size to minimize divergence and maximize coverage
// Consider using shared memory if repeated access to mask data is needed
// Use __syncthreads() if shared memory is implemented to synchronize threads
// Evaluate using loop unrolling to reduce loop overhead
```