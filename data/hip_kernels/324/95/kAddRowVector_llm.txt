// Utilize shared memory to cache vec elements accessed frequently within loop.
// Consider coalesced access patterns for mat and tgtMat to improve memory throughput.