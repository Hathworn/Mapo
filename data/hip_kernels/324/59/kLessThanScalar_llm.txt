// Consider using shared memory to reduce global memory access time.
// Ensure coalesced access for mat and target arrays for better performance.
// Check if entire grid dimension can be optimized based on available resources.