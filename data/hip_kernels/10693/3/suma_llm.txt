// Use shared memory for faster access to reduce global memory bandwidth
// Use atomic operation to safely write the result from multiple threads to prevent race conditions