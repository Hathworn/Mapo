```
// Use the stride loop for better SM occupancy
// Cache input to reduce repeated global memory accesses
// Simplify condition check
```