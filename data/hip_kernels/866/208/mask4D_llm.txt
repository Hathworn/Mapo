// Use shared memory to cache mask values for faster access
// Minimize the number of division and modulo operations for index calculation
// Avoid accessing global memory repeatedly by caching in local registers