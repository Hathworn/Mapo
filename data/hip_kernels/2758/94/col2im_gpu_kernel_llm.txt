// Optimize loop to handle all elements in parallel
// Improve memory access efficiency
// Reduce write contention by atomic addition