// Use register for sum to reduce global memory access
// Unroll loops for better efficiency
// Precompute scale outside loop to reduce redundant calculations
// Store the results back to global memory