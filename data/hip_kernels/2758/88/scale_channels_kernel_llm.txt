```c
// Use shared memory to cache scales_c values for better data reuse
// Ensure coalesced memory access to in_w_h_c and out arrays for efficient bandwidth usage
// Optimize index calculation to reduce division operations
```