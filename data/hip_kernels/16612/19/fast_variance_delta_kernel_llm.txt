```
// Unroll the inner loop to improve memory access efficiency.
// Use conditional assignment instead of branching for better performance.
// Utilize shared memory to store intermediate results and reduce global memory access.
// Perform reduction using a single thread after synchronizing all threads.
```