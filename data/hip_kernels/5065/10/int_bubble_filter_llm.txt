```
// Improved boundary check to reduce warp divergence
// Optimized initialization using shared memory for reduced global memory access
// Use shared memory
// Move final results from shared memory back to output
```