```
// Optimize: Ensure coalesced memory access for the input array
// Optimize: Ensure coalesced memory access for the output array
// Optimize: Minimize divergent branches in index calculation
```