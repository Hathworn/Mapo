// Optimized: Flattened 2D grid and block indices into a linear index to reduce complexity.
// Optimized: Direct calculation of input and output linear indices to enhance memory access patterns.
// Optimized: Ensure ix and iy are within bounds to avoid unnecessary computations.