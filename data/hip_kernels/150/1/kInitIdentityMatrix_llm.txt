// Use shared memory to reduce global memory access for the diagonal check.
// Consider optimizing memory access pattern to reduce warp divergence.
// Ensure memory alignment for improved access speed.