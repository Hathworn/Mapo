// Use shared memory for better performance if possible
// Direct computation for norm update
// Consider coalesced memory access for dV and dNorms
// Try to minimize atomic operations if possible