```cpp
// Use shared memory for row_sum and col_sum to reduce global memory access.
// Consider coalesced memory access patterns for the output array.
// Optimize branch to improve warp execution efficiency.
```