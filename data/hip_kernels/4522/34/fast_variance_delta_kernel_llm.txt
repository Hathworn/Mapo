```
// Ensure coalesced memory access for better performance
// Reduce the results from all threads using atomic add for better performance
```