// Cache rand[id] to reduce global memory access
// Simplify id calculation for 1D grid
// Use braces for better readability
// Compare once and scale if necessary
// Explicitly assign zero to improve clarity