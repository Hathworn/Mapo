```
// Cache rand[id] to avoid repeated access and reduce global memory reads
```