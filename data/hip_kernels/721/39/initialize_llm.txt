// Calculate the global index once to reduce redundant computations.
// Ensure memory access is within bounds to prevent out-of-bounds errors.
// Initialize states in proper stride to enhance memory coalescing.