```cpp
// Consider using shared memory to cache random states if accessed multiple times
// Optimize memory coalescing when accessing d_states to ensure efficient memory access
// Try to minimize divergent execution by structuring conditionals appropriately
// Explore using loop unrolling for additional performance gains in certain scenarios
```