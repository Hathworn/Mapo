// Optimize by computing tid only once  
// Initialize random state for each thread