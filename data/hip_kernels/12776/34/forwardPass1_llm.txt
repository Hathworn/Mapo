// Use a shared memory to reduce global memory accesses
// Use atomicAdd on shared memory
// Write results back to global memory