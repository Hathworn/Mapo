```c
// Consider coalescing memory accesses for d_rrr_index and d_rrr_sets
// Ensure optimal memory access patterns by aligning d_mask
// Use __restrict__ to potentially allow compiler optimizations
// Minimize branch divergence by handling edge cases uniformly
```