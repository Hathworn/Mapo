// Use shared memory and memory coalescing for improved performance