// Optimize using a stride loop and remove redundant calculations
// Use __ldg if supported for better cache efficiency