```
// Optimize: Calculate stride once to reduce repeated computation
// Optimize: Load dw[i] into a register to reduce global memory access
// Optimize: Compute square and reuse value
// Optimize: Reuse dwi for division
```