```c
// Ensure coalesced access by storing output sequentially
// Consider shared memory to store the input data
// Reduce global memory accesses by using registers for temporary variables
// Utilize constant memory for mask data to improve memory bandwidth
// Use loop unrolling to reduce loop overhead
```