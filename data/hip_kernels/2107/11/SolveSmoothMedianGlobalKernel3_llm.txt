```
// Use shared memory for 3x3 neighborhood to reduce global memory access
// Consider coalesced access patterns for improved performance
// Avoid redundant boundary checks by using padding in input matrices
// Further unroll loops or replace with fast sorting algorithms
```