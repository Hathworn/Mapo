// Use shared memory to minimize global memory access
// Combine loops for improved efficiency and branch reduction
// Utilize atomic operations for shared memory within a block
// Optimize thread and block configuration for better occupancy