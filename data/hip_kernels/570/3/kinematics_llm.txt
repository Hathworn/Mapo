```
// Check index within bounds in advance for better warp efficiency
// Optimize by avoiding recomputation of time_step*time_step
```