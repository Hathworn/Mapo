```c
// Consider using shared memory to reduce global memory access for val
// Apply loop unrolling in the inner loop to increase efficiency
// Ensure coalesced memory access for ptrs writes
```