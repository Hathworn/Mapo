```
// Ensure coalesced memory access for pred and truth arrays
// Utilize shared memory if possible to reduce global memory access latency
// Consider loop unrolling for the inner operations to enhance performance
// Minimize the use of logf inside loops for better efficiency
```