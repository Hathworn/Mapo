```cpp
// Unroll inner loop to improve performance
// Consider using shared memory to cache mean[filter] for faster access
// Optimize memory coalescing by ensuring that threads access global memory in a contiguous way
// Use a more advanced reduction technique to minimize synchronization overhead
```