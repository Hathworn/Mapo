```c
// Use coalesced memory access to enhance memory performance
// Ensure idx calculations are optimized for warp efficiency
// Consider using shared memory if intermediate results are needed
```
