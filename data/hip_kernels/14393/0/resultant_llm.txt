// Load data into registers to reduce global memory access
// Use fused multiply-add (FMA) to improve performance
// Check idx to avoid accessing out-of-bounds