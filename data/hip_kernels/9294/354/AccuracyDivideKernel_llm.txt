```cpp
// Ensure memory is coalesced for better performance
// Avoid warp divergence by keeping a single conditional branch
// Minimize the number of threads accessing the same memory location
```