```cpp
// Use shared memory for Ar and Aw to reduce global memory accesses.
// Consider coalesced memory access patterns for Ar and Aw to improve throughput.
// Reduce divergent branching within warp by organizing threads/tasks efficiently.
```