// Use const for repeated calculations to optimize register usage
// Add bounds check to reduce divergence