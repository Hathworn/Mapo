// Precompute inv_sqrt_var to reduce redundant calculations
// Precompute two_spatial_batch to avoid repeated division
// Optimize index calculation to minimize arithmetic operations
// Use stride to efficiently iterate through all elements