```
// Optimize boundary check for reduced branching
// Rearrange calculation for memory coalescing
```