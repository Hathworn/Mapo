// Consider using shared memory for data blocks to reduce global memory access latency.
// Use loop unrolling to optimize the dot product and adjustment loops.
// Use rsqrt instead of sqrt for faster norm calculation.