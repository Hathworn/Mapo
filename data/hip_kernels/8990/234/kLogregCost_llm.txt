```
// Optimization: Use shared memory to cache maxProbs and improve access time.
// Optimization: Prefetch labelp to reduce memory latency.
// Optimization: Unroll loop to reduce branch divergence in the for loop.
```