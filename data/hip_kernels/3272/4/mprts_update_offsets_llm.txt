```cpp
// Consider coalescing memory access for d_spine_sums to improve memory throughput.
// Ensure that d_spine_sums is aligned to segment size for optimal access patterns.
// Try using shared memory to cache d_spine_sums if accessed frequently within a block.
```