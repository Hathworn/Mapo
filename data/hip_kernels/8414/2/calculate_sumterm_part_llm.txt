// Pre-calculate the base index to reduce redundant calculations
// Pre-compute indices to reduce repetitive calculations
// Use temporary variables to reduce the number of accesses to Up and Vpl