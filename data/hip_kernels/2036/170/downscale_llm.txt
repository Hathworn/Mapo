```
// Unroll inner loops for better performance
// Use atomicAdd to avoid race conditions
```