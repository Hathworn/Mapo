// Use shared memory for mask to reduce global memory accesses
// Minimize conditional checks by using warp-level programming techniques