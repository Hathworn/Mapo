```cpp
// Optimize index calculation
// Calculate stride for grid stride loop
// Use grid stride loop for better load balancing
// Update input based on condition
```