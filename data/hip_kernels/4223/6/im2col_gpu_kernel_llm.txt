```c
// Ensure data access coalescing for data_col and data_im
// Use shared memory to cache data_im if possible
// Prefetch data_im elements to reduce latency
// Align memory accesses to improve performance
// Minimize conditional checks inside loops
// Consider loop unrolling for both inner and outer loops
```