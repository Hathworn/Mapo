```
// Use integer division and mod in a single step for better performance.
// Use precomputed indices for better memory alignment.
// Improved data race handling with atomic operation
```