```
// Unroll loop to improve memory access pattern
// Use a shared helper function to simplify repetitive code
// Remove the nested loop for applying compensation
// Precompute angle coefficients
// Flip using reverse indexing
```