// Use shared memory to minimize global memory access
// __syncthreads to ensure all threads have written to shared memory