// Use shared memory for d1_in to reduce global memory accesses
// Consider using warp-level primitives for better performance
// Optimize memory access patterns by ensuring coalesced accesses