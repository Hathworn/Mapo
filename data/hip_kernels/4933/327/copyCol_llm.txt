```c
// Combine ix and iy calculation for cleaner code
// Consider using shared memory to reduce repeated global memory accesses
```