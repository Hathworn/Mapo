// Use shared memory for faster access during the loop
// Atomic operation to prevent race conditions
// Atomic operation in the loop
// Write back to global memory from shared memory