```c
// Precompute the offset index to reduce repeated calculations
// Combine index computation and boundary check to minimize branches
// Ensure coalesced memory access by using consecutive threads
```