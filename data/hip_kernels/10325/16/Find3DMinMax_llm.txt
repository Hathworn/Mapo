```cpp
// Use shared memory to reduce global memory accesses.
// Merge conditions to minimize branching and improve memory access patterns.
// Consolidate min/max calculations to enhance instruction-level parallelism.
// Reduce load operations within inner loops for better cache utilization.
```