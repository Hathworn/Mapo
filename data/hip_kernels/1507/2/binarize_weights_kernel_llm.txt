```cpp
// Consider coalescing memory accesses to improve global memory efficiency.
// Use shared memory to further reduce global memory accesses.
// Ensure that accesses to the 'weights' array are memory coalesced.
```