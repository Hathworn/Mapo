// Use flattened grid and block indices for optimal thread mapping
// Check boundary condition before accessing global memory
// Efficient memory write by reducing condition checks