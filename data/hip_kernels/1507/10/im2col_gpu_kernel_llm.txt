```
// Use shared memory to cache data_im values and reduce global memory accesses.
// Optimize loop unrolling in the inner loops for better performance.
// Consider coalescing global memory reads to improve memory throughput.
// Prefetch data_im values if possible to hide memory latency.
// Minimize divergent branches by restructuring the conditional assignment.
```