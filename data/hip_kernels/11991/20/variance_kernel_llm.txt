```
// Calculate the scale once before the loop starts for efficiency
// Use grid-stride loop for better utilization of threads
// Unroll the loops for potential performance gain
```