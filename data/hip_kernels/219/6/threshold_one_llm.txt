```cpp
// Ensure coalesced memory access for vec and vec_thres arrays
// Consider using shared memory if data reuse occurs within the block
```