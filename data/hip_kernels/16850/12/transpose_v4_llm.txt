```
// Improved blockIdx calculation for better warp utilization
// Use shared memory to reduce global memory access latency
// Minor modification to prevent bank conflict
```