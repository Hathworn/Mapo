```cpp
// Consider coalescing memory access to proposals_idx and instance_labels to improve memory bandwidth.
// Use __syncthreads() efficiently to prevent unnecessary synchronization delays.
// Ensure shared memory usage is optimized to avoid bank conflicts.
// Optimize loop unrolling to reduce instruction count in inner loops.
```