```
// Optimize grid index calculation
// Reorder conditions to improve readability
// Use register for temporary sum
// Write back to global memory
```