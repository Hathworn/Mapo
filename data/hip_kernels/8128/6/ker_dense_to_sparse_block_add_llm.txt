// Precompute idx base offset and src access to reduce redundant computations
// Ensure id is within bounds to prevent out-of-bounds access
// Use the precomputed offset for sparse index calculation