// Optimize boundary handling by using min/max to reduce conditionals
// Unroll the loop for performance improvement
// Avoid redundant checks by using thread index constraint