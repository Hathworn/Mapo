```
// Calculate the position in forest array using idx instead of offset
// Ensure coalesced memory access by having each thread access consecutive memory locations
// Check idx bound first to avoid unnecessary work
```