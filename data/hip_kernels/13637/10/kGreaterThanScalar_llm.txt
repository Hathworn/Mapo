// Consider coalesced memory access by ensuring mat and target arrays are accessed linearly
// Avoid branching by potentially using arithmetic for boolean assignments
// Ensure alignment of data for better memory access efficiency