```
// Use shared memory for the `in` array to reduce global memory access
// Consider loop unrolling for improved performance
// Optimize stride calculations to minimize memory access latency
// Minimize divergent branches within the if-condition
```