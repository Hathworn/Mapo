// Cache weight value in a register for faster access
// Cache probabilities in a register to minimize memory access
// Simplify calculation of global thread index to reduce computational overhead