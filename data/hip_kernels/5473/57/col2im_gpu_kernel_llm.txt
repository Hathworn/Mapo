// Unroll loop for better performance
// Precompute some common expressions for efficiency
// Compute start and end for both dimensions using max to ensure non-negative start
// Unroll the innermost loop to increase throughput