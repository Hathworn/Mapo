// Calculate global index only once to reduce redundant computation
// Check if index is within bounds to avoid out-of-bounds memory access