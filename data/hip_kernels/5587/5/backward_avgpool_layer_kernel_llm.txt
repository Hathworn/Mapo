```
// Precompute division to avoid repeating the operation inside the loop.
// Optimize index calculation by precomputing constant parts.
// Use atomicAdd for thread safety when updating shared memory.
```