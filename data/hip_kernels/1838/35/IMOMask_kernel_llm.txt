```
// Optimize memory access by ensuring coalesced access patterns for d_IMOMask and d_IMO
// Minimize divergent branches by reordering operations or using warp-wide operations
// Consider using shared memory if multiple threads access the same elements
```