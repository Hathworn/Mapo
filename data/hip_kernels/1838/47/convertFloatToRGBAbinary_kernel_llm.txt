```cpp
// Ensure memory coalescing by accessing out_image and in_image linearly.
// Consider using shared memory for frequently accessed data.
// Minimize divergent branches by simplifying condition checks.
// Align data structures and allocations to improve memory access patterns.
// Optimize thread block dimensions for specific hardware capabilities.
```