// Use shared memory to enhance data locality.
// Adjust size of shared_nx if necessary.
// Cooperative loading of data into shared memory.
// Synchronize threads to ensure all shared data is loaded before use.
// Consider loop unrolling for performance improvement.
// Ensure memory access is coalesced for better efficiency.