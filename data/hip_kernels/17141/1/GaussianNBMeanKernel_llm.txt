```
// Cache class counts in shared memory to reduce global memory accesses
// Use __syncthreads() to ensure all threads have updated shared memory
```